{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport axios from 'axios';\nexport default {\n  name: 'CustomerPage',\n  setup() {\n    const showMyOptions = ref(false);\n    const showAddressDialog = ref(false);\n    const showOrderDialog = ref(false);\n    const addresses = ref([]);\n    const newAddress = ref({\n      uname: '',\n      uphone: '',\n      addressName: '',\n      umail: ''\n    });\n    const toggleMyOptions = () => {\n      showMyOptions.value = !showMyOptions.value;\n    };\n    const fetchAddresses = async () => {\n      const uid = localStorage.getItem('uid');\n      if (!uid) {\n        console.error('User ID not found in localStorage');\n        return;\n      }\n      try {\n        const response = await axios.get('/eShop/address/getuseraddress', {\n          params: {\n            uid: uid\n          }\n        });\n        if (response.data.code === 200) {\n          addresses.value = response.data.data;\n        } else {\n          console.error('Failed to fetch addresses:', response.data.msg);\n        }\n      } catch (error) {\n        console.error('Error fetching addresses:', error);\n      }\n    };\n    const addAddress = async () => {\n      const uid = localStorage.getItem('uid');\n      if (!uid) {\n        console.error('User ID not found in localStorage');\n        return;\n      }\n      try {\n        const response = await axios.post('/eShop/address/add', {\n          ...newAddress.value,\n          uid: uid\n        });\n        if (response.data.code === 200) {\n          alert('地址添加成功！');\n          fetchAddresses(); // 重新获取地址列表\n          newAddress.value = {\n            uname: '',\n            uphone: '',\n            addressName: '',\n            umail: ''\n          }; // 清空表单\n        } else {\n          alert('地址添加失败，请重试。');\n        }\n      } catch (error) {\n        console.error('Error adding address:', error);\n        alert('地址添加失败，请重试。');\n      }\n    };\n    const deleteAddress = async aid => {\n      try {\n        const response = await axios.delete(`/eShop/address/delete/${aid}`);\n        if (response.data.code === 200) {\n          alert('地址删除成功！');\n          fetchAddresses(); // 重新获取地址列表\n        } else {\n          alert('地址删除失败，请重试。');\n        }\n      } catch (error) {\n        console.error('Error deleting address:', error);\n        alert('地址删除失败，请重试。');\n      }\n    };\n    onMounted(() => {\n      const jwt = localStorage.getItem('jwt');\n      if (jwt) {\n        axios.defaults.headers.common['Authorization'] = `${jwt}`;\n      }\n      fetchAddresses();\n    });\n    return {\n      showMyOptions,\n      showAddressDialog,\n      showOrderDialog,\n      addresses,\n      newAddress,\n      toggleMyOptions,\n      fetchAddresses,\n      addAddress,\n      deleteAddress\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","name","setup","showMyOptions","showAddressDialog","showOrderDialog","addresses","newAddress","uname","uphone","addressName","umail","toggleMyOptions","value","fetchAddresses","uid","localStorage","getItem","console","error","response","get","params","data","code","msg","addAddress","post","alert","deleteAddress","aid","delete","jwt","defaults","headers","common"],"sources":["E:\\Vue\\jsproject\\shop\\src\\views\\CustomerPage.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <!-- 侧边悬浮栏 -->\r\n    <div class=\"sidebar\">\r\n      <div class=\"sidebar-item\" @click=\"showCartDialog\">\r\n        <img src=\"/icon/cart (1).png\" alt=\"购物车\" class=\"icon\" />\r\n        <span class=\"badge\">{{ cartCount }}</span>\r\n        <p>购物车</p>\r\n      </div>\r\n      <div class=\"sidebar-item\" @click=\"toggleMyOptions\">\r\n        <img src=\"/icon/my.png\" alt=\"我的\" class=\"icon\" />\r\n        <p>我的</p>\r\n        <!-- 浮动选项 -->\r\n        <div v-if=\"showMyOptions\" class=\"floating-options\">\r\n          <button @click=\"showAddressDialog = true; showMyOptions = false;\">地址</button>\r\n          <button @click=\"showOrderDialog = true; showMyOptions = false;\">订单</button>\r\n        </div>\r\n      </div>\r\n      <div class=\"sidebar-item\">\r\n        <img src=\"/icon/service.png\" alt=\"客服\" class=\"icon\" />\r\n        <p>客服</p>\r\n      </div>\r\n      <div class=\"sidebar-item\">\r\n        <img src=\"/icon/post.png\" alt=\"反馈\" class=\"icon\" />\r\n        <p>反馈</p>\r\n      </div>\r\n      <div class=\"sidebar-item\" @click=\"scrollToTop\">\r\n        <img src=\"/icon/top (1).png\" alt=\"回顶部\" class=\"icon\" />\r\n        <p>回顶部</p>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 地址管理对话框 -->\r\n    <el-dialog v-model=\"showAddressDialog\" title=\"地址管理\" :width=\"600\">\r\n      <div class=\"address-list\">\r\n        <div v-for=\"address in addresses\" :key=\"address.aid\" class=\"address-item\">\r\n          <p>姓名: {{ address.uname }}</p>\r\n          <p>电话: {{ address.uphone }}</p>\r\n          <p>地址: {{ address.addressName }}</p>\r\n          <p>邮箱: {{ address.umail }}</p>\r\n          <button @click=\"deleteAddress(address.aid)\">删除</button>\r\n        </div>\r\n      </div>\r\n      <div class=\"add-address\">\r\n        <h3>新增地址</h3>\r\n        <input v-model=\"newAddress.uname\" placeholder=\"姓名\" />\r\n        <input v-model=\"newAddress.uphone\" placeholder=\"电话\" />\r\n        <input v-model=\"newAddress.addressName\" placeholder=\"地址\" />\r\n        <input v-model=\"newAddress.umail\" placeholder=\"邮箱\" />\r\n        <button @click=\"addAddress\">添加地址</button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!-- 订单管理对话框 -->\r\n    <el-dialog v-model=\"showOrderDialog\" title=\"订单管理\" :width=\"600\">\r\n      <!-- 订单管理内容 -->\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from 'vue';\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  name: 'CustomerPage',\r\n  setup() {\r\n    const showMyOptions = ref(false);\r\n    const showAddressDialog = ref(false);\r\n    const showOrderDialog = ref(false);\r\n    const addresses = ref([]);\r\n    const newAddress = ref({\r\n      uname: '',\r\n      uphone: '',\r\n      addressName: '',\r\n      umail: '',\r\n    });\r\n\r\n    const toggleMyOptions = () => {\r\n      showMyOptions.value = !showMyOptions.value;\r\n    };\r\n\r\n    const fetchAddresses = async () => {\r\n      const uid = localStorage.getItem('uid');\r\n      if (!uid) {\r\n        console.error('User ID not found in localStorage');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await axios.get('/eShop/address/getuseraddress', {\r\n          params: { uid: uid },\r\n        });\r\n        if (response.data.code === 200) {\r\n          addresses.value = response.data.data;\r\n        } else {\r\n          console.error('Failed to fetch addresses:', response.data.msg);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching addresses:', error);\r\n      }\r\n    };\r\n\r\n    const addAddress = async () => {\r\n      const uid = localStorage.getItem('uid');\r\n      if (!uid) {\r\n        console.error('User ID not found in localStorage');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await axios.post('/eShop/address/add', {\r\n          ...newAddress.value,\r\n          uid: uid,\r\n        });\r\n        if (response.data.code === 200) {\r\n          alert('地址添加成功！');\r\n          fetchAddresses(); // 重新获取地址列表\r\n          newAddress.value = { uname: '', uphone: '', addressName: '', umail: '' }; // 清空表单\r\n        } else {\r\n          alert('地址添加失败，请重试。');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error adding address:', error);\r\n        alert('地址添加失败，请重试。');\r\n      }\r\n    };\r\n\r\n    const deleteAddress = async (aid) => {\r\n      try {\r\n        const response = await axios.delete(`/eShop/address/delete/${aid}`);\r\n        if (response.data.code === 200) {\r\n          alert('地址删除成功！');\r\n          fetchAddresses(); // 重新获取地址列表\r\n        } else {\r\n          alert('地址删除失败，请重试。');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error deleting address:', error);\r\n        alert('地址删除失败，请重试。');\r\n      }\r\n    };\r\n\r\n    onMounted(() => {\r\n      const jwt = localStorage.getItem('jwt');\r\n      if (jwt) {\r\n        axios.defaults.headers.common['Authorization'] = `${jwt}`;\r\n      }\r\n      fetchAddresses();\r\n    });\r\n\r\n    return {\r\n      showMyOptions,\r\n      showAddressDialog,\r\n      showOrderDialog,\r\n      addresses,\r\n      newAddress,\r\n      toggleMyOptions,\r\n      fetchAddresses,\r\n      addAddress,\r\n      deleteAddress,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.app-container {\r\n  position: relative;\r\n  min-height: 100vh;\r\n  background: linear-gradient(to bottom, #b3e5fc, #f8bbd0);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding-top: 20px;\r\n}\r\n\r\n.sidebar {\r\n  position: fixed;\r\n  top: 50%;\r\n  right: 0;\r\n  transform: translateY(-50%);\r\n  background-color: white;\r\n  border-radius: 10px 0 0 10px;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\r\n  z-index: 5000;\r\n  padding: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  height: 380px;\r\n  width: 60px;\r\n}\r\n\r\n.sidebar-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex: 1;\r\n  width: 100%;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n  position: relative;\r\n  padding-top: 8px;\r\n}\r\n\r\n.sidebar-item p {\r\n  margin-top: 2px;\r\n}\r\n\r\n.sidebar-item:hover {\r\n  background-color: #f0f0f0;\r\n}\r\n\r\n.icon {\r\n  width: 24px;\r\n  height: 24px;\r\n  margin-bottom: 2px;\r\n}\r\n\r\n.badge {\r\n  position: absolute;\r\n  top: 5px;\r\n  right: 5px;\r\n  background-color: red;\r\n  color: white;\r\n  border-radius: 50%;\r\n  padding: 2px 6px;\r\n  font-size: 12px;\r\n}\r\n\r\n.floating-options {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: -100px;\r\n  transform: translateY(-50%);\r\n  background-color: white;\r\n  border: 1px solid #ccc;\r\n  border-radius: 5px;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\r\n  z-index: 1000;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 10px;\r\n}\r\n\r\n.floating-options button {\r\n  margin-bottom: 5px;\r\n  padding: 5px 10px;\r\n  background-color: #e0f7fa;\r\n  color: #007bff;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.floating-options button:hover {\r\n  background-color: #b3e5fc;\r\n}\r\n\r\n.el-dialog {\r\n  width: 600px !important;\r\n  max-width: 90vw;\r\n}\r\n\r\n.address-list {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.address-item {\r\n  border-bottom: 1px solid #e0e0e0;\r\n  padding: 10px 0;\r\n}\r\n\r\n.add-address {\r\n  margin-top: 20px;\r\n}\r\n\r\n.add-address input {\r\n  display: block;\r\n  margin-bottom: 10px;\r\n  padding: 5px;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n}\r\n</style>\r\n"],"mappings":"AA6DA,SAASA,GAAG,EAAEC,SAAQ,QAAS,KAAK;AACpC,OAAOC,KAAI,MAAO,OAAO;AAEzB,eAAe;EACbC,IAAI,EAAE,cAAc;EACpBC,KAAKA,CAAA,EAAG;IACN,MAAMC,aAAY,GAAIL,GAAG,CAAC,KAAK,CAAC;IAChC,MAAMM,iBAAgB,GAAIN,GAAG,CAAC,KAAK,CAAC;IACpC,MAAMO,eAAc,GAAIP,GAAG,CAAC,KAAK,CAAC;IAClC,MAAMQ,SAAQ,GAAIR,GAAG,CAAC,EAAE,CAAC;IACzB,MAAMS,UAAS,GAAIT,GAAG,CAAC;MACrBU,KAAK,EAAE,EAAE;MACTC,MAAM,EAAE,EAAE;MACVC,WAAW,EAAE,EAAE;MACfC,KAAK,EAAE;IACT,CAAC,CAAC;IAEF,MAAMC,eAAc,GAAIA,CAAA,KAAM;MAC5BT,aAAa,CAACU,KAAI,GAAI,CAACV,aAAa,CAACU,KAAK;IAC5C,CAAC;IAED,MAAMC,cAAa,GAAI,MAAAA,CAAA,KAAY;MACjC,MAAMC,GAAE,GAAIC,YAAY,CAACC,OAAO,CAAC,KAAK,CAAC;MACvC,IAAI,CAACF,GAAG,EAAE;QACRG,OAAO,CAACC,KAAK,CAAC,mCAAmC,CAAC;QAClD;MACF;MAEA,IAAI;QACF,MAAMC,QAAO,GAAI,MAAMpB,KAAK,CAACqB,GAAG,CAAC,+BAA+B,EAAE;UAChEC,MAAM,EAAE;YAAEP,GAAG,EAAEA;UAAI;QACrB,CAAC,CAAC;QACF,IAAIK,QAAQ,CAACG,IAAI,CAACC,IAAG,KAAM,GAAG,EAAE;UAC9BlB,SAAS,CAACO,KAAI,GAAIO,QAAQ,CAACG,IAAI,CAACA,IAAI;QACtC,OAAO;UACLL,OAAO,CAACC,KAAK,CAAC,4BAA4B,EAAEC,QAAQ,CAACG,IAAI,CAACE,GAAG,CAAC;QAChE;MACF,EAAE,OAAON,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;MACnD;IACF,CAAC;IAED,MAAMO,UAAS,GAAI,MAAAA,CAAA,KAAY;MAC7B,MAAMX,GAAE,GAAIC,YAAY,CAACC,OAAO,CAAC,KAAK,CAAC;MACvC,IAAI,CAACF,GAAG,EAAE;QACRG,OAAO,CAACC,KAAK,CAAC,mCAAmC,CAAC;QAClD;MACF;MAEA,IAAI;QACF,MAAMC,QAAO,GAAI,MAAMpB,KAAK,CAAC2B,IAAI,CAAC,oBAAoB,EAAE;UACtD,GAAGpB,UAAU,CAACM,KAAK;UACnBE,GAAG,EAAEA;QACP,CAAC,CAAC;QACF,IAAIK,QAAQ,CAACG,IAAI,CAACC,IAAG,KAAM,GAAG,EAAE;UAC9BI,KAAK,CAAC,SAAS,CAAC;UAChBd,cAAc,CAAC,CAAC,EAAE;UAClBP,UAAU,CAACM,KAAI,GAAI;YAAEL,KAAK,EAAE,EAAE;YAAEC,MAAM,EAAE,EAAE;YAAEC,WAAW,EAAE,EAAE;YAAEC,KAAK,EAAE;UAAG,CAAC,EAAE;QAC5E,OAAO;UACLiB,KAAK,CAAC,aAAa,CAAC;QACtB;MACF,EAAE,OAAOT,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;QAC7CS,KAAK,CAAC,aAAa,CAAC;MACtB;IACF,CAAC;IAED,MAAMC,aAAY,GAAI,MAAOC,GAAG,IAAK;MACnC,IAAI;QACF,MAAMV,QAAO,GAAI,MAAMpB,KAAK,CAAC+B,MAAM,CAAC,yBAAyBD,GAAG,EAAE,CAAC;QACnE,IAAIV,QAAQ,CAACG,IAAI,CAACC,IAAG,KAAM,GAAG,EAAE;UAC9BI,KAAK,CAAC,SAAS,CAAC;UAChBd,cAAc,CAAC,CAAC,EAAE;QACpB,OAAO;UACLc,KAAK,CAAC,aAAa,CAAC;QACtB;MACF,EAAE,OAAOT,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;QAC/CS,KAAK,CAAC,aAAa,CAAC;MACtB;IACF,CAAC;IAED7B,SAAS,CAAC,MAAM;MACd,MAAMiC,GAAE,GAAIhB,YAAY,CAACC,OAAO,CAAC,KAAK,CAAC;MACvC,IAAIe,GAAG,EAAE;QACPhC,KAAK,CAACiC,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,IAAI,GAAGH,GAAG,EAAE;MAC3D;MACAlB,cAAc,CAAC,CAAC;IAClB,CAAC,CAAC;IAEF,OAAO;MACLX,aAAa;MACbC,iBAAiB;MACjBC,eAAe;MACfC,SAAS;MACTC,UAAU;MACVK,eAAe;MACfE,cAAc;MACdY,UAAU;MACVG;IACF,CAAC;EACH;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}