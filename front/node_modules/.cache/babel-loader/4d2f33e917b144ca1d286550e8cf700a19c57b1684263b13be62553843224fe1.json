{"ast":null,"code":"import { ref } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport axios from 'axios';\nexport default {\n  name: 'LoginPage',\n  setup() {\n    const loginForm = ref({\n      username: '',\n      password: ''\n    });\n    const registerForm = ref({\n      u_name: '',\n      password: '',\n      email: ''\n    });\n    const forgotPasswordForm = ref({\n      email: '',\n      code: ''\n    });\n    const resetForm = ref({\n      newUsername: '',\n      newPassword: ''\n    });\n    const showRegister = ref(false);\n    const showForgotPassword = ref(false);\n    const isCodeVerified = ref(false);\n    const handleLogin = async () => {\n      try {\n        const response = await axios.post('/eShop/user/login', {\n          uname: loginForm.value.username,\n          password: loginForm.value.password\n        });\n        const {\n          code,\n          msg,\n          data\n        } = response.data;\n        if (code === 200 && msg === '成功') {\n          ElMessage.success('登录成功');\n          if (data === '商家') {\n            window.location.href = '/merchant-dashboard';\n          } else if (data === '顾客') {\n            window.location.href = '/customer-dashboard';\n          }\n        } else {\n          ElMessage.error(data || '登录失败');\n        }\n      } catch (error) {\n        ElMessage.error('请求失败，请稍后重试');\n      }\n    };\n    const handleRegister = async () => {\n      try {\n        const response = await axios.post('/eShop/user/register', {\n          uname: registerForm.value.u_name,\n          password: registerForm.value.password,\n          email: registerForm.value.email\n        });\n        const {\n          code,\n          msg\n        } = response.data;\n        if (code === 200 && msg === '注册成功') {\n          ElMessage.success('注册成功');\n          showRegister.value = false;\n        } else {\n          ElMessage.error(msg || '注册失败');\n        }\n      } catch (error) {\n        ElMessage.error('请求失败，请稍后重试');\n      }\n    };\n    const sendVerificationCode = async () => {\n      try {\n        await axios.get(`/eShop/user/sendemail/${forgotPasswordForm.value.email}`);\n        ElMessage.success('验证码已发送，请检查您的邮箱');\n      } catch (error) {\n        ElMessage.error('发送验证码失败，请稍后重试');\n      }\n    };\n    const verifyCode = async () => {\n      try {\n        const response = await axios.post('/eShop/user/checkcode', {\n          email: forgotPasswordForm.value.email,\n          code: forgotPasswordForm.value.code\n        });\n        const {\n          data\n        } = response.data;\n        if (data === true) {\n          ElMessage.success('验证码验证成功');\n          isCodeVerified.value = true;\n        } else {\n          ElMessage.error('验证码错误，请重新获取');\n        }\n      } catch (error) {\n        ElMessage.error('验证失败，请稍后重试');\n      }\n    };\n    const resetPassword = async () => {\n      try {\n        const response = await axios.post('/eShop/user/reset', {\n          email: forgotPasswordForm.value.email,\n          newUsername: resetForm.value.newUsername,\n          newPassword: resetForm.value.newPassword\n        });\n        const {\n          code,\n          msg\n        } = response.data;\n        if (code === 200 && msg === '重置成功') {\n          ElMessage.success('密码重置成功');\n          showForgotPassword.value = false;\n          isCodeVerified.value = false;\n        } else {\n          ElMessage.error(msg || '重置失败');\n        }\n      } catch (error) {\n        ElMessage.error('请求失败，请稍后重试');\n      }\n    };\n    return {\n      loginForm,\n      registerForm,\n      forgotPasswordForm,\n      resetForm,\n      showRegister,\n      showForgotPassword,\n      isCodeVerified,\n      handleLogin,\n      handleRegister,\n      sendVerificationCode,\n      verifyCode,\n      resetPassword\n    };\n  }\n};","map":{"version":3,"names":["ref","ElMessage","axios","name","setup","loginForm","username","password","registerForm","u_name","email","forgotPasswordForm","code","resetForm","newUsername","newPassword","showRegister","showForgotPassword","isCodeVerified","handleLogin","response","post","uname","value","msg","data","success","window","location","href","error","handleRegister","sendVerificationCode","get","verifyCode","resetPassword"],"sources":["E:\\Vue\\jsproject\\shop\\src\\views\\Login.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-container\">\r\n    <el-card class=\"login-card\">\r\n      <h2 class=\"login-title\">登录</h2>\r\n      <el-form :model=\"loginForm\" @submit.prevent=\"handleLogin\">\r\n        <el-form-item>\r\n          <el-input v-model=\"loginForm.username\" placeholder=\"用户名\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-input\r\n            v-model=\"loginForm.password\"\r\n            type=\"password\"\r\n            placeholder=\"密码\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"handleLogin\">登录</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div class=\"options\">\r\n        <el-button class=\"option-button\" type=\"text\" @click=\"showRegister = true\">注册</el-button>\r\n        <el-button class=\"option-button\" type=\"text\" @click=\"showForgotPassword = true\">忘记密码</el-button>\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 注册对话框 -->\r\n    <el-dialog v-model=\"showRegister\" title=\"注册\">\r\n      <el-form :model=\"registerForm\">\r\n        <el-form-item>\r\n          <el-input v-model=\"registerForm.u_name\" placeholder=\"用户名\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-input\r\n            v-model=\"registerForm.password\"\r\n            type=\"password\"\r\n            placeholder=\"密码\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-input v-model=\"registerForm.email\" placeholder=\"邮箱\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"handleRegister\">提交注册</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-dialog>\r\n\r\n    <!-- 忘记密码对话框 -->\r\n    <el-dialog v-model=\"showForgotPassword\" title=\"忘记密码\">\r\n      <el-form v-if=\"!isCodeVerified\" :model=\"forgotPasswordForm\">\r\n        <el-form-item>\r\n          <el-input v-model=\"forgotPasswordForm.email\" placeholder=\"邮箱\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"sendVerificationCode\">获取验证码</el-button>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-input v-model=\"forgotPasswordForm.code\" placeholder=\"验证码\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"verifyCode\">验证验证码</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n      <el-form v-else :model=\"resetForm\">\r\n        <el-form-item>\r\n          <el-input v-model=\"resetForm.newUsername\" placeholder=\"新用户名\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-input\r\n            v-model=\"resetForm.newPassword\"\r\n            type=\"password\"\r\n            placeholder=\"新密码\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"resetPassword\">重置密码</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue';\r\nimport { ElMessage } from 'element-plus';\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  name: 'LoginPage',\r\n  setup() {\r\n    const loginForm = ref({\r\n      username: '',\r\n      password: '',\r\n    });\r\n\r\n    const registerForm = ref({\r\n      u_name: '',\r\n      password: '',\r\n      email: '',\r\n    });\r\n\r\n    const forgotPasswordForm = ref({\r\n      email: '',\r\n      code: '',\r\n    });\r\n\r\n    const resetForm = ref({\r\n      newUsername: '',\r\n      newPassword: '',\r\n    });\r\n\r\n    const showRegister = ref(false);\r\n    const showForgotPassword = ref(false);\r\n    const isCodeVerified = ref(false);\r\n\r\n    const handleLogin = async () => {\r\n      try {\r\n        const response = await axios.post('/eShop/user/login', {\r\n          uname: loginForm.value.username,\r\n          password: loginForm.value.password,\r\n        });\r\n\r\n        const { code, msg, data } = response.data;\r\n\r\n        if (code === 200 && msg === '成功') {\r\n          ElMessage.success('登录成功');\r\n          if (data === '商家') {\r\n            window.location.href = '/merchant-dashboard';\r\n          } else if (data === '顾客') {\r\n            window.location.href = '/customer-dashboard';\r\n          }\r\n        } else {\r\n          ElMessage.error(data || '登录失败');\r\n        }\r\n      } catch (error) {\r\n        ElMessage.error('请求失败，请稍后重试');\r\n      }\r\n    };\r\n\r\n    const handleRegister = async () => {\r\n      try {\r\n        const response = await axios.post('/eShop/user/register', {\r\n          uname: registerForm.value.u_name,\r\n          password: registerForm.value.password,\r\n          email: registerForm.value.email,\r\n        });\r\n\r\n        const { code, msg } = response.data;\r\n\r\n        if (code === 200 && msg === '注册成功') {\r\n          ElMessage.success('注册成功');\r\n          showRegister.value = false;\r\n        } else {\r\n          ElMessage.error(msg || '注册失败');\r\n        }\r\n      } catch (error) {\r\n        ElMessage.error('请求失败，请稍后重试');\r\n      }\r\n    };\r\n\r\n    const sendVerificationCode = async () => {\r\n      try {\r\n        await axios.get(`/eShop/user/sendemail/${forgotPasswordForm.value.email}`);\r\n        ElMessage.success('验证码已发送，请检查您的邮箱');\r\n      } catch (error) {\r\n        ElMessage.error('发送验证码失败，请稍后重试');\r\n      }\r\n    };\r\n\r\n    const verifyCode = async () => {\r\n      try {\r\n        const response = await axios.post('/eShop/user/checkcode', {\r\n          email: forgotPasswordForm.value.email,\r\n          code: forgotPasswordForm.value.code,\r\n        });\r\n\r\n        const { data } = response.data;\r\n\r\n        if (data === true) {\r\n          ElMessage.success('验证码验证成功');\r\n          isCodeVerified.value = true;\r\n        } else {\r\n          ElMessage.error('验证码错误，请重新获取');\r\n        }\r\n      } catch (error) {\r\n        ElMessage.error('验证失败，请稍后重试');\r\n      }\r\n    };\r\n\r\n    const resetPassword = async () => {\r\n      try {\r\n        const response = await axios.post('/eShop/user/reset', {\r\n          email: forgotPasswordForm.value.email,\r\n          newUsername: resetForm.value.newUsername,\r\n          newPassword: resetForm.value.newPassword,\r\n        });\r\n\r\n        const { code, msg } = response.data;\r\n\r\n        if (code === 200 && msg === '重置成功') {\r\n          ElMessage.success('密码重置成功');\r\n          showForgotPassword.value = false;\r\n          isCodeVerified.value = false;\r\n        } else {\r\n          ElMessage.error(msg || '重置失败');\r\n        }\r\n      } catch (error) {\r\n        ElMessage.error('请求失败，请稍后重试');\r\n      }\r\n    };\r\n\r\n    return {\r\n      loginForm,\r\n      registerForm,\r\n      forgotPasswordForm,\r\n      resetForm,\r\n      showRegister,\r\n      showForgotPassword,\r\n      isCodeVerified,\r\n      handleLogin,\r\n      handleRegister,\r\n      sendVerificationCode,\r\n      verifyCode,\r\n      resetPassword,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.login-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100vh;\r\n  margin: 0;\r\n  background-image: url('@/assets/在线购物平台登录界面设计 (4).png');\r\n  background-size: cover;\r\n  background-repeat: no-repeat;\r\n  background-position: center;\r\n}\r\n\r\n.login-card {\r\n  width: 350px;\r\n  padding: 30px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n  border-radius: 10px;\r\n  background-color: rgba(255, 255, 255, 0.9);\r\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\r\n  position: relative;\r\n}\r\n\r\n.login-card:hover {\r\n  transform: translateY(-5px);\r\n  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.login-title {\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n  color: #333;\r\n  font-weight: bold;\r\n}\r\n\r\n.el-input {\r\n  border-radius: 5px;\r\n}\r\n\r\n.el-button {\r\n  width: 100%;\r\n  border-radius: 5px;\r\n  background-color: #66a6ff;\r\n  color: #fff;\r\n  font-weight: bold;\r\n}\r\n\r\n.el-button:hover {\r\n  background-color: #5591e6;\r\n}\r\n\r\n.options {\r\n  position: absolute;\r\n  bottom: 10px;\r\n  right: 50px; /* 调整右边距以与登录按钮对齐 */\r\n  display: flex;\r\n  gap: 10px;\r\n}\r\n\r\n.option-button {\r\n  width: 80px; /* 统一按钮宽度 */\r\n  text-align: center;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}